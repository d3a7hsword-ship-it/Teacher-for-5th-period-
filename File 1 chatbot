# chatbot.py
import datetime
import json
import requests

# URL to your knowledge file on GitHub
# IMPORTANT: Replace YOUR_USERNAME with your actual GitHub username
GITHUB_JSON_URL = "https://raw.githubusercontent.com/YOUR_USERNAME/TeacherAI/main/knowledge_online.json"

def load_knowledge():
    try:
        response = requests.get(GITHUB_JSON_URL)
        response.raise_for_status()
        return response.json()
    except Exception as e:
        print("Error loading online knowledge:", e)
        return {}

def get_response(user_input, knowledge):
    user_input = user_input.lower()

    # Greetings
    for key, response in knowledge.get("greetings", {}).items():
        if key in user_input:
            return response

    # Definitions
    for subject, topics in knowledge.get("definitions", {}).items():
        for key, response in topics.items():
            if key in user_input:
                return response

    # Date/Time
    now = datetime.datetime.now()
    if "day" in user_input:
        return f"Today is {now.strftime('%A')}"
    if "date" in user_input:
        return f"Today is {now.strftime('%A, %B %d, %Y')}"
    if "time" in user_input:
        return f"The current time is {now.strftime('%I:%M %p')}"

    # Fallback
    return "I’m still learning — try asking about science, math, or time!"

# Load knowledge dynamically
knowledge_base = load_knowledge()

print("AI Teacher: Hello! Ask me a question, or type 'bye' to quit.")
while True:
    user_input = input("You: ")
    if user_input.lower() == "bye":
        print("AI Teacher: Goodbye!")
        break
    print("AI Teacher:", get_response(user_input, knowledge_base))
